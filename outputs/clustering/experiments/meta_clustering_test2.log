14:29:56 - INFO - ================================================================================
14:29:56 - INFO - CLUSTERING: PIPELINE_B_300_POST_EXP8_LOCAL_LEAF
14:29:56 - INFO - ================================================================================
14:29:56 - INFO - 
================================================================================
14:29:56 - INFO - EXTRACTING SKILLS
14:29:56 - INFO - ================================================================================
/Users/nicocamacho/Documents/Tesis/observatorio-demanda-laboral/scripts/clustering_analysis.py:64: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql_query(query, conn)
14:31:18 - INFO -    ‚úÖ Extracted 2401 unique skills
14:31:18 - INFO -    Frequency range: 1 - 294
14:31:18 - INFO -    Total mentions: 9,458
14:31:18 - INFO - 
================================================================================
14:31:18 - INFO - FETCHING EMBEDDINGS
14:31:18 - INFO - ================================================================================
14:31:18 - INFO - Requesting embeddings for 2401 skills...
14:31:18 - INFO -    ‚úÖ Found embeddings: 1937/2401
14:31:18 - INFO -    Coverage: 80.7%
14:31:18 - WARNING -    ‚ö†Ô∏è  Missing 464 skills
14:31:18 - INFO -    Using 1937 skills with embeddings
14:31:18 - INFO - 
================================================================================
14:31:18 - INFO - RUNNING UMAP (src/analyzer/dimension_reducer.py)
14:31:18 - INFO - ================================================================================
14:31:18 - INFO - DimensionReducer initialized: n_components=2, n_neighbors=5, min_dist=0.1, metric=cosine
14:31:18 - INFO - Fitting UMAP on 1937 samples with 768 features
14:31:18 - INFO - Parameters: n_neighbors=5, min_dist=0.1, metric=cosine
/Users/nicocamacho/Documents/Tesis/observatorio-demanda-laboral/venv/lib/python3.11/site-packages/umap/umap_.py:1943: UserWarning: n_jobs value -1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
UMAP(angular_rp_forest=True, metric='cosine', n_neighbors=5, random_state=42, verbose=True)
Sat Nov  8 14:31:18 2025 Construct fuzzy simplicial set
Sat Nov  8 14:31:20 2025 Finding Nearest Neighbors
Sat Nov  8 14:31:21 2025 Finished Nearest Neighbor Search
Sat Nov  8 14:31:22 2025 Construct embedding
Epochs completed:   0%|            0/500 [00:00]Epochs completed:   0%|            1/500 [00:00]Epochs completed:  15%| ‚ñà‚ñå         75/500 [00:00]Epochs completed:  30%| ‚ñà‚ñà‚ñâ        148/500 [00:00]Epochs completed:  44%| ‚ñà‚ñà‚ñà‚ñà‚ñç      221/500 [00:00]Epochs completed:  59%| ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ     294/500 [00:00]Epochs completed:  73%| ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   367/500 [00:00]Epochs completed:  88%| ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  440/500 [00:00]Epochs completed: 100%| ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 500/500 [00:00]
14:31:23 - INFO - UMAP transformation complete
14:31:23 - INFO - Output shape: (1937, 2)
14:31:23 - INFO - Coordinate ranges: X=[-4.67, 15.87], Y=[0.60, 16.15]
14:31:23 - INFO - 
================================================================================
14:31:23 - INFO - RUNNING HDBSCAN (src/analyzer/clustering.py)
14:31:23 - INFO - ================================================================================
14:31:23 - INFO - SkillClusterer initialized: min_cluster_size=3, min_samples=2, metric=euclidean
14:31:23 - INFO - Clustering 1937 samples in 2D space
14:31:23 - INFO - Parameters: min_cluster_size=3, min_samples=2
14:31:23 - INFO - Clustering complete
14:31:23 - INFO - Clusters detected: 305
14:31:23 - INFO - Noise points: 313 (16.2%)
14:31:23 - INFO - Cluster sizes: {256: 10, 292: 10, 247: 3, 291: 3, 170: 7, 299: 4, 298: 10, 297: 5, 75: 3, 104: 7, 122: 7, 150: 4, 3: 4, 277: 8, 239: 3, 301: 6, 287: 4, 145: 4, 32: 4, 84: 8, 213: 13, 109: 11, 22: 4, 94: 6, 33: 9, 85: 4, 59: 7, 181: 10, 229: 6, 185: 6, 300: 4, 144: 8, 143: 3, 114: 6, 8: 9, 208: 6, 146: 5, 271: 5, 68: 4, 102: 6, 230: 9, 57: 10, 273: 5, 295: 6, 216: 8, 9: 6, 276: 8, 76: 10, 14: 4, 50: 10, 188: 9, 92: 4, 20: 7, 243: 3, 13: 3, 103: 12, 46: 15, 281: 5, 154: 8, 252: 3, 179: 9, 25: 11, 303: 3, 255: 6, 15: 3, 279: 3, 202: 3, 0: 4, 2: 8, 74: 9, 116: 4, 108: 6, 249: 7, 283: 7, 115: 9, 206: 5, 304: 5, 56: 10, 149: 4, 204: 9, 296: 5, 268: 6, 91: 5, 245: 4, 17: 11, 43: 4, 209: 4, 81: 5, 118: 6, 178: 4, 47: 7, 220: 3, 163: 3, 286: 4, 222: 5, 6: 6, 184: 8, 211: 4, 173: 3, 45: 6, 226: 4, 60: 5, 78: 5, 139: 5, 90: 4, 217: 5, 203: 5, 66: 4, 198: 15, 130: 6, 259: 6, 172: 8, 34: 6, 87: 3, 54: 4, 86: 6, 37: 6, 196: 5, 135: 4, 270: 4, 5: 3, 199: 6, 223: 10, 7: 7, 237: 8, 152: 9, 290: 4, 136: 5, 72: 3, 38: 4, 65: 4, 124: 6, 248: 4, 242: 5, 278: 4, 131: 4, 119: 5, 123: 4, 214: 8, 195: 5, 83: 6, 35: 8, 193: 3, 285: 3, 263: 6, 174: 23, 228: 5, 79: 8, 73: 4, 80: 8, 175: 3, 82: 7, 246: 6, 225: 5, 98: 6, 111: 8, 42: 7, 62: 3, 302: 3, 288: 3, 27: 10, 1: 5, 264: 9, 113: 6, 26: 4, 106: 3, 183: 5, 120: 3, 127: 5, 284: 4, 262: 3, 205: 4, 61: 3, 240: 7, 55: 3, 11: 4, 265: 4, 166: 3, 53: 4, 40: 5, 267: 6, 93: 3, 194: 5, 289: 5, 29: 7, 44: 4, 250: 4, 12: 8, 189: 3, 99: 4, 129: 5, 117: 3, 254: 3, 171: 3, 233: 3, 201: 3, 280: 3, 164: 9, 96: 4, 275: 4, 218: 4, 167: 3, 97: 3, 221: 5, 234: 3, 71: 3, 70: 4, 293: 5, 69: 5, 142: 5, 294: 5, 140: 3, 138: 8, 31: 3, 212: 5, 19: 5, 231: 9, 4: 3, 232: 5, 36: 4, 155: 3, 227: 3, 236: 4, 30: 3, 258: 7, 269: 4, 187: 6, 219: 4, 151: 4, 88: 3, 180: 7, 134: 13, 161: 3, 153: 3, 64: 5, 156: 5, 253: 3, 160: 4, 186: 6, 241: 3, 272: 3, 105: 4, 107: 13, 137: 9, 162: 3, 16: 3, 49: 6, 133: 4, 112: 8, 190: 3, 158: 3, 191: 3, 215: 3, 147: 4, 67: 4, 18: 4, 77: 3, 10: 5, 235: 4, 21: 4, 257: 10, 100: 6, 110: 6, 266: 4, 251: 5, 24: 4, 244: 3, 274: 6, 200: 6, 168: 4, 238: 4, 192: 4, 282: 4, 261: 4, 165: 4, 39: 3, 125: 5, 58: 3, 148: 3, 89: 5, 177: 4, 28: 4, 121: 5, 159: 7, 128: 4, 260: 3, 176: 4, 141: 5, 197: 6, 41: 5, 157: 5, 224: 4, 101: 3, 169: 5, 48: 4, 51: 8, 182: 4, 207: 3, 95: 3, 63: 4, 52: 3, 132: 5, 210: 3, 126: 6, 23: 3}
14:31:23 - INFO - Quality metrics calculated:
14:31:23 - INFO -   Silhouette: 0.618
14:31:23 - INFO -   Davies-Bouldin: 0.439
14:31:23 - INFO - 
üìä Clustering Results:
14:31:23 - INFO -    Clusters: 305
14:31:23 - INFO -    Noise: 313 (16.2%)
14:31:23 - INFO -    Silhouette: 0.618
14:31:23 - INFO -    Davies-Bouldin: 0.439
14:31:23 - INFO - 
üìä Analyzing clusters...
14:31:23 - INFO - 
================================================================================
14:31:23 - INFO - META-CLUSTERING (Hierarchical Grouping)
14:31:23 - INFO - ================================================================================
14:31:23 - INFO - Clustering 305 fine-grained clusters into meta-clusters...
14:31:23 - INFO - Meta-clusters detected: 5
14:31:23 - INFO - Unclustered fine clusters: 219
14:31:23 - INFO - Meta-clustering Silhouette: 0.117
14:31:23 - INFO - Meta-clustering Davies-Bouldin: 2.134
14:31:23 - INFO - 
‚è≠  Skipping temporal analysis (no temporal_sql_query in config)
14:31:23 - INFO - 
================================================================================
14:31:23 - INFO - GENERATING VISUALIZATIONS
14:31:23 - INFO - ================================================================================
14:31:23 - INFO - 
üé® UMAP scatter plot (enhanced)...
14:31:32 - INFO -    ‚úÖ Saved: umap_scatter.png (enhanced with labels)
14:31:32 - INFO - 
‚è≠  Skipping temporal visualizations (no temporal data available)
14:31:32 - INFO - 
================================================================================
14:31:32 - INFO - GENERATING HIERARCHICAL VISUALIZATIONS
14:31:32 - INFO - ================================================================================
/Users/nicocamacho/Documents/Tesis/observatorio-demanda-laboral/scripts/clustering_analysis.py:486: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed two minor releases later. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap(obj)`` instead.
  cmap = cm.get_cmap('tab20')
14:31:32 - INFO - 
üé® Fine-grained view (colored by meta-cluster)...
14:31:33 - INFO -    ‚úÖ Saved: umap_fine_by_meta.png
14:31:33 - INFO - 
üé® Macro view (cluster centroids)...
14:31:37 - INFO -    ‚úÖ Saved: umap_macro_centroids.png
14:31:37 - INFO - 
================================================================================
14:31:37 - INFO - SAVING RESULTS
14:31:37 - INFO - ================================================================================
	completed  0  /  500 epochs
	completed  50  /  500 epochs
	completed  100  /  500 epochs
	completed  150  /  500 epochs
	completed  200  /  500 epochs
	completed  250  /  500 epochs
	completed  300  /  500 epochs
	completed  350  /  500 epochs
	completed  400  /  500 epochs
	completed  450  /  500 epochs
Sat Nov  8 14:31:22 2025 Finished embedding
Traceback (most recent call last):
  File "/Users/nicocamacho/Documents/Tesis/observatorio-demanda-laboral/scripts/clustering_analysis.py", line 738, in <module>
    main()
  File "/Users/nicocamacho/Documents/Tesis/observatorio-demanda-laboral/scripts/clustering_analysis.py", line 723, in main
    save_results(df, clusters, metrics, temporal_matrix, config, output_dir)
  File "/Users/nicocamacho/Documents/Tesis/observatorio-demanda-laboral/scripts/clustering_analysis.py", line 337, in save_results
    json.dump(results, f, indent=2)
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type int64 is not JSON serializable
